<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
    <title>layout 后台大布局 - Layui</title>
    <link rel="stylesheet" th:href="@{/layui/css/layui.css}"/>
    <script th:src="@{/layui/layui.js}"></script>
    <script th:src="@{/self/common/shadow.js}"></script>
</head>
<body class="layui-layout-body">
<div class="layui-layout layui-layout-admin">

    <div th:include="/common/head :: html"></div>

    <div class="layui-body">
        <!-- 内容主体区域 -->
        <div style="padding: 15px;">
            <table class="layui-hide" id="demo"></table>
        </div>
    </div>

    <div th:include="/common/foot :: html"></div>

</div>

<script>
    var create;

    layui.use(['table','util','element','jquery','layer','form'], function(){
        $ = layui.jquery;
        var table = layui.table;
        var util = layui.util;
        var layer = layui.layer;

        deleteDeployed = function(deploymentId){
            shadow_();
            $.ajax({
                url: "/bpm/deployed/delete",
                data: {deploymentId: deploymentId},
                dataType: "json",
                async: false,
                success: function (data) {
                    alertText(data);
                    modelList();
                },
                error: function (data) {
                    alertText(data);
                    modelList();
                }
            })
        };

        modelList = function(){
            table.render({
                elem: '#demo'
                ,url:'/bpm/deployed/list'
                ,count: 'count'
                ,cols: [[
                    {field:'ID', title: '流程定义ID',width:'20%',sort: true}
                    ,{field:'name', title: '流程名称',width:'30%',sort: true}
                    ,{field:'deploymentId', title: '部署ID',width:'20%',sort: true}
                    ,{title: '操作',width:'30%', templet: '<div><button class="layui-btn layui-btn-sm" onclick="deleteDeployed({{d.deploymentId}})">删除</button>' +
                    '<button class="layui-btn layui-btn-sm" onclick="deleteDeployed({{d.deploymentId}})">配置</button>' +
                    '</div>'}
                ]]
            });
        };

        modelList();

    });

</script>

</body>
</html>